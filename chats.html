<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chats - LoveMap</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/components.css">
</head>
<body>
  <!-- SVG Icon Gradients -->
  <svg class="svg-defs">
    <defs>
      <linearGradient id="navGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
      </linearGradient>
    </defs>
  </svg>

  <div class="app-header">
    <div class="header-content">
      <h1 class="header-title">Chats</h1>
    </div>
  </div>

  <div class="chat-list" id="chatList">
    <!-- Chats will be injected here -->
  </div>

  <!-- Navigation Bar -->
  <nav class="nav-bar">
    <a href="map.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
        <circle cx="12" cy="10" r="3"></circle>
      </svg>
      <small>Map</small>
    </a>
    <a href="chats.html" class="nav-item active">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <small>Chats</small>
    </a>
    <a href="notifications.html" class="nav-item" style="position: relative;">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <small>Notifications</small>
      <span class="nav-badge" id="notificationBadge" style="display: none;">0</span>
    </a>
    <a href="profile.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
      <small>Profile</small>
    </a>
  </nav>

  <script src="js/app.js"></script>
  <script>
    // Check authentication
    checkAuth();

    // Mock chat data with matched users
    const mockChats = [
      {
        id: 1,
        userId: 3,
        name: 'Emma Davis',
        initials: 'ED',
        lastMessage: 'Would love to! What time works for you?',
        time: '2m ago',
        unread: 2
      },
      {
        id: 2,
        userId: 5,
        name: 'Olivia Martinez',
        initials: 'OM',
        lastMessage: 'That sounds amazing! üèÉ‚Äç‚ôÄÔ∏è',
        time: '1h ago',
        unread: 0
      },
      {
        id: 3,
        userId: 7,
        name: 'Sophia Lee',
        initials: 'SL',
        lastMessage: 'Thanks! I had a great time too üòä',
        time: '3h ago',
        unread: 0
      },
      {
        id: 4,
        userId: 2,
        name: 'Michael Chen',
        initials: 'MC',
        lastMessage: 'I know a great Italian place downtown',
        time: '1d ago',
        unread: 1
      },
      {
        id: 5,
        userId: 6,
        name: 'Daniel Brown',
        initials: 'DB',
        lastMessage: "Are you into jazz? There's a concert this weekend",
        time: '2d ago',
        unread: 0
      }
    ];

    // Render chat list
    function renderChats() {
      const chatList = document.getElementById('chatList');
      
      if (mockChats.length === 0) {
        chatList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üí¨</div>
            <div class="empty-state-text">No chats yet</div>
            <p style="color: var(--text-secondary); margin-top: 8px;">
              Start matching with people to begin chatting!
            </p>
          </div>
        `;
        return;
      }

      chatList.innerHTML = mockChats.map(chat => `
        <div class="chat-item" onclick="openChat(${chat.userId})">
          <div class="chat-avatar">${chat.initials}</div>
          <div class="chat-content">
            <div class="chat-header">
              <div class="chat-name">${chat.name}</div>
              <div class="chat-time">${chat.time}</div>
            </div>
            <div class="chat-message ${chat.unread > 0 ? 'unread' : ''}">
              ${chat.lastMessage}
              ${chat.unread > 0 ? `<span class="chat-badge">${chat.unread}</span>` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    // Open chat with user
    function openChat(userId) {
      // In a real app, this would open the chat conversation
      alert(`Opening chat with user ${userId}. Full chat functionality coming soon!`);
    }

    // Update notification badge
    function updateNotificationBadge() {
      const badge = document.getElementById('notificationBadge');
      const count = getUnreadNotificationsCount();
      
      if (count > 0) {
        badge.textContent = count;
        badge.style.display = 'block';
      } else {
        badge.style.display = 'none';
      }
    }

    // Initialize
    renderChats();
    updateNotificationBadge();
  </script>
</body>
</html>
